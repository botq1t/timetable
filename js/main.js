"use strict";let settings,defaultSettings={colorScheme:"light",colorSchemeDark:"dark",colorSchemeDarkBegin:72e3,colorSchemeDarkEnd:28800,defaultGroup:null,dynamicTitle:!0,sounds:!0};localStorage.settings&&(localStorage.timetable_settings=localStorage.settings,localStorage.removeItem("settings")),localStorage.timetable_settings||(localStorage.timetable_settings=JSON.stringify(defaultSettings)),settings=JSON.parse(localStorage.timetable_settings),console.log("Settings",settings);export{settings};import{dayName,getDate}from"./modules/date.js";let date=getDate().date,dayIndex=getDate().dayIndex,timeInSeconds=getDate().timeInSeconds;console.log("====================== date ========================"),console.log("Дата:",date),console.log("Номер дня:",dayIndex),console.log("Время в секундах:",timeInSeconds),console.log("====================== date end ========================"),setInterval((function(){date=getDate().date,dayIndex=getDate().dayIndex,timeInSeconds=getDate().timeInSeconds}),1e3);export{date,dayIndex,timeInSeconds};import{getWeekIndex}from"./modules/date.js";let weekIndex=getWeekIndex(date);const nowWeekIndex=getWeekIndex(date);export{nowWeekIndex};console.log("Номер текущей недели:",weekIndex);import{getLessonAmount}from"./modules/lessonBreak.js";let nextDayIndex=dayIndex+1;function getCurrentLessonIndex(){for(var e=1;e<=4;e++)if(timeInSeconds>=lessonTimeSeconds[e].begin&&timeInSeconds<lessonTimeSeconds[e].end)var n=e;return n}nextDayIndex>6&&(nextDayIndex=1),console.log("Завтра:",dayName[nextDayIndex]);import{getRemain}from"./modules/date.js";import{hlToday}from"./modules/date.js";import{setWeekParity}from"./modules/date.js";import{getNextDay}from"./modules/date.js";import{displayDate}from"./modules/date.js";import{highlightCurrentLesson}from"./modules/lessonBreak.js";$(document).ready((function(){displayDate(date,dayIndex,nowWeekIndex),setInterval((function(){displayDate(date,dayIndex,nowWeekIndex)}),1e3),getRemain(date),setInterval((function(){getRemain(date)}),1e3),hlToday(dayIndex),setWeekParity(weekIndex),$(".week__parity").click((function(){weekIndex++,setWeekParity(weekIndex)})),getNextDay(117,300,dayIndex,timeInSeconds,getLessonAmount(117),nextDayIndex),getNextDay(217,300,dayIndex,timeInSeconds,getLessonAmount(217),nextDayIndex),highlightCurrentLesson(dayIndex),setInterval((function(){highlightCurrentLesson(dayIndex)}),1e3)}));import{setColorScheme}from"./modules/colorSchemes.js";settings.colorSchemeDarkBegin>settings.colorSchemeDarkEnd?timeInSeconds>=settings.colorSchemeDarkBegin||timeInSeconds<settings.colorSchemeDarkEnd?setColorScheme(settings.colorSchemeDark):setColorScheme(settings.colorScheme):timeInSeconds<settings.colorSchemeDarkEnd&&timeInSeconds>=settings.colorSchemeDarkBegin?setColorScheme(settings.colorSchemeDark):setColorScheme(settings.colorScheme);import{createSchedule,lessons}from"./modules/schedule.js";import{setLessonType}from"./modules/lessonBreak.js";console.log("Расписания",lessons),createSchedule(117),createSchedule(217),setLessonType(".lesson__type");import{lessonTime,lessonTimeSeconds,breakTime,breakTimeSeconds}from"./modules/lessonTime.js";console.log("Пары:",lessonTime),console.log("Пары в секундах",lessonTimeSeconds),console.log("Перерывы",breakTime),console.log("Перерывы в секундах",breakTimeSeconds);for(let e in lessonTime)$(`.time_${e}`).each((function(){$(this).children(".time__start").text(lessonTime[e].begin),$(this).children(".time__end").text(lessonTime[e].end)}));import{fullLessonName,fullTeacherName}from"./modules/lessonTeacherName.js";$(".lesson__name").click(fullLessonName),$(".now__name").click(fullLessonName),$(".lesson__teacher").click(fullTeacherName);import{titleBirthCheker}from"./modules/titleChanger.js";titleBirthCheker(date,settings.dynamicTitle);import{getCurrentBreakIndex}from"./modules/lessonBreak.js";import{getHMS,getTimeString}from"./modules/date.js";let nowLesson={117:{now:[],next:[]},217:{now:[],next:[]}},nowDayIndex=null;function nowCreateArray(e){nowLesson[e]={now:[],next:[]};var n=1,s=1;for(nowLesson[e].now.push(null);null!=lessons[e][dayIndex][n];){switch(lessons[e][dayIndex][n].parity){case"both":nowLesson[e].now.push({name:"",type:"",auditory:"",endTime:0}),nowLesson[e].now[s].name=lessons[e][dayIndex][n].name,nowLesson[e].now[s].type=lessons[e][dayIndex][n].type,nowLesson[e].now[s].auditory=lessons[e][dayIndex][n].auditory,nowLesson[e].now[s].endTime=lessonTimeSeconds[s].end,s++;break;case"odd":weekIndex%2!=0&&(nowLesson[e].now.push({name:"",type:"",auditory:"",endTime:0}),nowLesson[e].now[s].name=lessons[e][dayIndex][n].name,nowLesson[e].now[s].type=lessons[e][dayIndex][n].type,nowLesson[e].now[s].auditory=lessons[e][dayIndex][n].auditory,nowLesson[e].now[s].endTime=lessonTimeSeconds[s].end,s++);break;case"even":weekIndex%2==0&&(nowLesson[e].now.push({name:"",type:"",auditory:"",endTime:0}),nowLesson[e].now[s].name=lessons[e][dayIndex][n].name,nowLesson[e].now[s].type=lessons[e][dayIndex][n].type,nowLesson[e].now[s].auditory=lessons[e][dayIndex][n].auditory,nowLesson[e].now[s].endTime=lessonTimeSeconds[s].end,s++)}n++}for(let n=0;n<nowLesson[e].now.length-1;n++){for(nowLesson[e].next.push({name:"",type:"",auditory:"",beginTime:0}),s=n+1;"no"==nowLesson[e].now[s].name;)s++;nowLesson[e].next[n].name=nowLesson[e].now[s].name,nowLesson[e].next[n].type=nowLesson[e].now[s].type,nowLesson[e].next[n].auditory=nowLesson[e].now[s].auditory,nowLesson[e].next[n].beginTime=lessonTimeSeconds[s].begin}}function nowCreateLessons(e){let n=`#now-${e}`,s=$(n).children(".current");s.empty();for(let t=1;t<nowLesson[e].now.length;t++)s=$(n).children(".current"),s.append(`<div class="now__lesson now__lesson_${t}"></div>`),s=s.children().last(),s.append(`\n\t\t\t<div class="now__auditory now__item">Сейчас (${nowLesson[e].now[t].auditory})</div>\n\t\t\t<div class="now__body now__item">\n\t\t\t\t<div class="now__name">${nowLesson[e].now[t].name}</div>\n\t\t\t\t<div class="now__type">${nowLesson[e].now[t].type}</div>\n\t\t\t</div>\n\t\t\t<div class="now__countdown now__item">End in MM minutes (lil break in MM)</div>\n\t\t`),"no"==nowLesson[e].now[t].name&&s.remove();s=$(n).children(".next"),s.empty();for(let t=0;t<nowLesson[e].next.length;t++)s=$(n).children(".next"),s.append(`<div class="now__lesson now__lesson_${t}"></div>`),s=s.children().last(),s.append(`\n\t\t\t<div class="now__auditory now__item">Следующая (${nowLesson[e].next[t].auditory})</div>\n\t\t\t<div class="now__body now__item">\n\t\t\t\t<div class="now__name">${nowLesson[e].next[t].name}</div>\n\t\t\t\t<div class="now__type">${nowLesson[e].next[t].type}</div>\n\t\t\t</div>\n\t\t\t<div class="now__countdown now__item">Begin in MM minutes</div>\n\t\t`)}function nowTimeUpdate(e){let n=`#now-${e}`,s=getCurrentLessonIndex();if(s&&s<=getLessonAmount(e)){let t=$(n).children(".current").children(`.now__lesson_${s}`).children(".now__countdown"),o=nowLesson[e].now[s].endTime-timeInSeconds;o=getHMS(o),o=getTimeString(o.hours,o.minutes,o.seconds),t.html(`До конца пары: ${o}`)}if(void 0===s&&(s=timeInSeconds<lessonTimeSeconds[1].begin?0:getCurrentBreakIndex()),null!=s&&s<getLessonAmount(e)){let t=$(n).children(".next").children(`.now__lesson_${s}`).children(".now__countdown"),o=nowLesson[e].next[s].beginTime-timeInSeconds;o=getHMS(o),o=getTimeString(o.hours,o.minutes,o.seconds),t.html(`До начала пары: ${o}`)}}function nowUpdate(){nowDayIndex!=dayIndex&&(nowDayIndex=dayIndex,console.log("now update"),nowCreateArray(117),nowCreateArray(217),nowCreateLessons(117),nowCreateLessons(217),console.log("Сегодняшние пары",nowLesson)),lessons[117][dayIndex].lessons&&nowTimeUpdate(117),lessons[217][dayIndex].lessons&&nowTimeUpdate(217),timeInSeconds>=0&&timeInSeconds<=3&&(nowDisplayItemsUpdate(117),nowDisplayItemsUpdate(217));for(let e=1;e<=4;e++)timeInSeconds>=lessonTimeSeconds[e].begin-2&&timeInSeconds<=lessonTimeSeconds[e].end+2&&(nowDisplayItemsUpdate(117),nowDisplayItemsUpdate(217))}function nowDisplayItems(e){let n=`#now-${e}`;if(!1===lessons[e][dayIndex].lessons)$(n).children(".now__gone").addClass("active").css("display","flex").html('<span class="icon-bokal"></span>Выходной!<span class="icon-bokal"></span>');else if(timeInSeconds<lessonTimeSeconds[1].begin)$(n).children(".next").addClass("active").css("display","flex"),$(n).children(".next").children(".now__lesson_0").addClass("active").css("display","flex");else if(timeInSeconds>=lessonTimeSeconds[getLessonAmount(e)].end)$(n).children(".now__gone").addClass("active").html('<span class="icon-happy"></span>На сегодня пары закончились!<span class="icon-happy"></span>').css("display","flex");else{$(n).children(".now__content").addClass("active").css("display","flex");let s=getCurrentLessonIndex();s&&$(n).children(".current").children(`.now__lesson_${s}`).addClass("active").css("display","flex"),s==getLessonAmount(e)&&$(n).children(".current").addClass("noNext"),void 0===s&&(s=getCurrentBreakIndex()),null!=s&&s<getLessonAmount(e)&&$(n).children(".next").children(`.now__lesson_${s}`).addClass("active").css("display","flex")}}function nowDisplayItemsUpdate(e){let n=`#now-${e}`;if(!1===lessons[e][dayIndex].lessons)$(n).children(".now__content").hasClass("active")&&$(n).children(".now__content").removeClass("active").slideUp(300),!1===$(n).children(".now__gone").hasClass("active")&&$(n).children(".now__gone").addClass("active").slideDown(300,(function(){$(this).css("display","flex")})),$(n).children(".now__gone").html('<span class="icon-bokal"></span>Выходной!<span class="icon-bokal"></span>');else if(timeInSeconds<lessonTimeSeconds[1].begin)$(n).children(".now__gone").hasClass("active")&&$(n).children(".now__gone").removeClass("active").slideUp(300),$(n).children(".current").hasClass("active")&&$(n).children(".current").removeClass("active").slideUp(300),!1===$(n).children(".next").hasClass("active")&&$(n).children(".next").addClass("active").delay(300).slideDown(300,(function(){$(this).css("display","flex")})),$(n).children(".next").children().not(".now__lesson_0").each((function(){$(this).hasClass("active")&&$(this).removeClass("active").slideUp(300)})),!1===$(n).children(".next").children(".now__lesson_0").hasClass("active")&&$(n).children(".next").children(".now__lesson_0").addClass("active").slideDown(300,(function(){$(this).css("display","flex")}));else if(timeInSeconds>=lessonTimeSeconds[getLessonAmount(e)].end)$(n).children(".now__content").hasClass("active")&&$(n).children(".now__content").removeClass("active").slideUp(300),!1===$(n).children(".now__gone").hasClass("active")&&$(n).children(".now__gone").addClass("active").html('<span class="icon-happy"></span>На сегодня пары закончились!<span class="icon-happy"></span>').slideDown(300,(function(){$(this).css("display","flex")}));else{!1===$(n).children(".now__content").hasClass("active")&&$(n).children(".now__content").addClass("active").slideDown(300,(function(){$(this).css("display","flex")})),$(n).children(".now__gone").hasClass("active")&&$(n).children(".now__gone").removeClass("active").slideUp(300);let s=getCurrentLessonIndex();s?($(n).children(".current").children().not(`.now__lesson_${s}`).each((function(){$(this).hasClass("active")&&$(this).removeClass("active").slideUp(300)})),!1===$(n).children(".current").children(`.now__lesson_${s}`).hasClass("active")&&$(n).children(".current").children(`.now__lesson_${s}`).addClass("active").slideDown(300,(function(){$(this).css("display","flex")}))):$(n).children(".current").children(".now__lesson").hasClass("active")&&$(n).children(".current").children(".now__lesson").removeClass("active").slideUp(300),s==getLessonAmount(e)&&!1===$(n).children(".current").hasClass("noNext")&&$(n).children(".current").addClass("noNext"),void 0===s&&(s=getCurrentBreakIndex()),null!=s&&s<getLessonAmount(e)?($(n).children(".next").children().not(`.now__lesson_${s}`).each((function(){$(this).hasClass("active")&&$(this).removeClass("active").slideUp(300)})),!1===$(n).children(".next").children(`.now__lesson_${s}`).hasClass("active")&&$(n).children(".next").children(`.now__lesson_${s}`).addClass("active").slideDown(300,(function(){$(this).css("display","flex")}))):$(n).children(".next").children(".now__lesson").hasClass("active")&&$(n).children(".next").children(".now__lesson").removeClass("active").slideUp(300)}}nowUpdate(),setInterval(nowUpdate,1e3),nowUpdate(),setInterval(nowUpdate,1e3),nowDisplayItems(117),nowDisplayItems(217);import{getFirstLesson}from"./modules/lessonBreak.js";function getPrefsTime(e){let n="",s=Math.floor(settings[e]/3600);return s<10&&(n+="0"),n+=s,n+=":",s=(settings[e]-3600*s)/60,s<10&&(n+="0"),n+=s,n}function checkPrefsGroup(){$("#prefs-target").addClass("active"),$("body").addClass("lock"),$(".prefs__tab").removeClass("active"),$(".prefs__card").removeClass("active"),$("#prefs_tab_other").addClass("active"),$("#prefs_target_other").addClass("active"),alert("Выберите свою группу плез)")}settings.defaultGroup&&(0==dayIndex||timeInSeconds<lessonTimeSeconds[getFirstLesson(settings.defaultGroup)].begin||timeInSeconds>=lessonTimeSeconds[getLessonAmount(settings.defaultGroup)].end)&&($("#now").removeClass("active"),$("#now-target").css("display","none"),$(`#u${settings.defaultGroup}`).addClass("active"),$(`#u${settings.defaultGroup}-target`).css("display","flex")),$(".nav__tab").each((function(){if($(this).hasClass("active")){let e=$(this).attr("id");$(`#${e}-target`).css("display","flex")}})),$(".nav__tab").click((function(){if("Инфо"!=$(this).html()&&!$(this).hasClass("active")){let e=$(this).attr("id");$(".nav__tab").removeClass("active"),$(this).addClass("active"),$(".main__tab").fadeOut(150),$(`#${e}-target`).delay(160).fadeIn(150,(function(){$(this).css("display","flex")}))}})),$(".day__name").click((function(){$(this).hasClass("slide")?$(this).next().slideUp(300):$(this).next().slideDown(300,(function(){$(this).css("display","grid")})),$(this).toggleClass("slide")})),settings.defaultGroup||setTimeout(checkPrefsGroup,2e3),$(".prefs__block").each((function(){let e=$(this).attr("id");if(e=e.split("_")[1],$(this).hasClass("time")){let n=getPrefsTime(e);$(this).children(".prefs__options").children().children().val(n)}else $(this).children(".prefs__options").children().each((function(){let n=$(this).attr("id");n=n.split("_")[2],n==String(settings[e])&&$(this).addClass("active")}))})),$(".prefs__tab").click((function(){$(".prefs__tab").removeClass("active"),$(".prefs__card").removeClass("active"),$(this).addClass("active");let e=$(this).attr("id");e=e.split("_")[2],$(`#prefs_target_${e}`).addClass("active")})),$(".prefs__options").children("il").click((function(){$(this).parent().children().removeClass("active"),$(this).addClass("active")})),$(".prefs__close").click((function(){$("#prefs-target").removeClass("active"),$("body").removeClass("lock")})),$("#prefs").click((function(){$("#prefs-target").addClass("active"),$("body").addClass("lock")})),$(".prefs__submit").click((function(){$(".prefs__options").each((function(){if($(this).children("il").hasClass("time")){let e=$(this).children().children().val(),n=$(this).children().children().attr("name"),s=3600*+e.split(":")[0]+60*+e.split(":")[1];settings[n]=s}else $(this).children().each((function(){let e=$(this).attr("id"),n=e.split("_")[1];e=e.split("_")[2],$(this).hasClass("active")&&(isNaN(Number(e))?settings[n]="true"==e||"false"!=e&&e:settings[n]=+e)}))})),localStorage.timetable_settings=JSON.stringify(settings),document.location.reload()}));import{soundsObject,playSound}from"./modules/sounds.js";$(".lesson__teacher").click((function(){let e=$(this).text();e=e.split(" ")[0],e in soundsObject&&playSound(e)})),$(".lesson__name").click((function(){let e=$(this).next().next().next().text();e=e.split(" ")[0],e in soundsObject&&playSound(e)})),$(".lesson__time").click((function(){let e=$(this).text();e=e.split(":")[0],e=e.slice(-2),e in soundsObject&&playSound(e)})),$(".lesson__auditory").click((function(){settings.sounds&&playSound("auditory")})),$(".lesson_out").click((function(){let e=$(this).text();e in soundsObject&&playSound(e)})),$(".nav__tab").click((function(){let e=$(this).text();e=e.split(" ")[0],e in soundsObject&&playSound(e)})),$(".day__name").click((function(){let e=$(this).text();e=e.split(" ")[0],e in soundsObject&&playSound(e)})),$(".now__title").click((function(){let e=$(this).text();e=e.split(" ")[0],e in soundsObject&&playSound(e)})),$(".now__gone").click((function(){let e=$(this).text();e in soundsObject&&playSound(e)})),$(".week__parity").click((function(){settings.sounds&&playSound("parity")})),$(".header__title").click((function(){settings.sounds&&playSound("Сейчас")}));